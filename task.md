# C++17 围棋项目任务规划：命令行版 WGo 实现

将 WGo.js 用 C++17 重写为命令行应用是一个很好的学习项目。以下是一个分步骤的任务规划，帮助你系统地完成这个项目，同时学习 C++17 的新特性。

## 项目概述

**项目名称**：ConsoleGo  
**功能**：命令行围棋应用，支持基本落子、棋盘显示、SGF导入导出  
**技术栈**：C++17

## 阶段一：项目设置与基础结构

### 任务 1.1：设置项目结构
- 创建项目目录结构
- 设置 CMake 或其他构建系统
- 创建基本的 README 和文档

### 任务 1.2：设计核心数据结构
- 设计 `Position` 类（表示棋子位置）
- 设计 `Stone` 类（表示黑白棋子）
- 设计 `Board` 类（表示棋盘状态）
- 使用 C++17 的 `std::optional` 表示可能为空的棋子位置

### 任务 1.3：实现基本的命令行界面
- 创建简单的命令行解析器
- 实现基本的用户交互循环
- 使用 C++17 的结构化绑定简化命令解析

## 阶段二：围棋核心逻辑实现

### 任务 2.1：棋盘表示与基本操作
- 实现棋盘初始化
- 实现添加和移除棋子的功能
- 使用 C++17 的 `std::variant` 处理不同类型的棋盘元素

### 任务 2.2：围棋规则实现
- 实现气的计算
- 实现提子规则
- 实现打劫规则
- 使用 C++17 的 `if constexpr` 优化条件逻辑

### 任务 2.3：游戏状态管理
- 实现游戏历史记录
- 实现悔棋功能
- 实现局面评估
- 使用 C++17 的 `std::any` 存储多样化的游戏状态信息

## 阶段三：命令行界面优化

### 任务 3.1：棋盘文本显示
- 实现美观的 ASCII 棋盘显示
- 添加坐标标记
- 优化不同终端环境下的显示
- 使用 C++17 的字符串视图（`std::string_view`）优化字符串处理

### 任务 3.2：用户交互增强
- 实现命令补全
- 添加帮助信息
- 实现错误处理和提示
- 使用 C++17 的结构化绑定简化用户输入处理

### 任务 3.3：游戏流程控制
- 实现游戏开始/结束逻辑
- 添加计时功能
- 实现保存/加载当前游戏
- 使用 C++17 的 `std::filesystem` 处理文件操作

## 阶段四：SGF 文件支持

### 任务 4.1：SGF 解析器
- 实现 SGF 文件格式解析
- 处理基本 SGF 属性
- 处理变化和注释
- 使用 C++17 的折叠表达式简化递归解析

### 任务 4.2：导入 SGF 功能
- 从 SGF 文件加载棋局
- 处理 SGF 中的特殊标记
- 实现变化选择
- 使用 C++17 的 `if` 初始化语句简化条件检查

### 任务 4.3：导出 SGF 功能
- 将当前棋局保存为 SGF 格式
- 支持添加注释和标记
- 处理变化序列
- 使用 C++17 的结构化绑定简化 SGF 节点构建

## 阶段五：高级功能与优化

### 任务 5.1：性能优化
- 使用 C++17 的并行算法优化计算密集型操作
- 实现缓存机制提高重复计算效率
- 优化内存使用
- 使用 C++17 的 `std::invoke` 统一函数调用接口

### 任务 5.2：添加分析功能
- 实现简单的形势判断
- 添加死活判断
- 提供基本提示功能
- 使用 C++17 的 `std::optional` 表示可能不存在的分析结果

### 任务 5.3：测试与文档
- 编写单元测试
- 创建集成测试
- 完善用户文档
- 使用 C++17 的静态断言和类型特性改进代码质量

## C++17 学习重点

在每个任务中，你可以重点学习以下 C++17 特性：

| 特性 | 描述 | 应用场景 |
|------|------|----------|
| 结构化绑定 | 简化多返回值处理 | 命令解析、坐标处理 |
| std::optional | 优雅处理可能不存在的值 | 棋子位置、AI建议 |
| std::variant | 类型安全的联合体 | 棋盘元素表示 |
| std::any | 存储任意类型的值 | 游戏状态信息 |
| std::string_view | 非拥有字符串引用 | 命令处理、SGF解析 |
| std::filesystem | 文件系统操作 | SGF文件处理 |
| if constexpr | 编译时条件判断 | 规则判断优化 |
| 折叠表达式 | 简化可变参数模板 | SGF解析器 |
| if/switch 初始化语句 | 简化作用域和条件判断 | 输入验证 |
| 并行算法 | 利用多核处理器 | 形势分析 |
| 内联变量 | 简化头文件常量定义 | 配置常量 |
| constexpr if | 编译时条件分支 | 模板特化 |
| std::invoke | 统一函数调用接口 | 命令处理系统 |

## 执行建议

1. 按照阶段顺序逐步实现功能
2. 每完成一个小任务就进行测试
3. 在每个任务中有意识地应用 C++17 新特性
4. 保持代码模块化，便于后续扩展
5. 定期提交代码，记录学习进度